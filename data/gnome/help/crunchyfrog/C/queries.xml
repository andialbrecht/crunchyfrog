<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<chapter id="crunchyfrog-queries" lang="en" xmlns:xi="http://www.w3.org/2001/XInclude">
	<title>Database Queries</title>
	<section id="sqleditor">
		<title>SQL Editor</title>
		<para>
			A SQL editor can be opened in the following ways:
		</para>
		<variablelist>
			<varlistentry>
				<term>Menubar</term>
				<listitem><para>Choose
					<menuchoice>
						<guimenu>File</guimenu>
						<guisubmenu>New</guisubmenu>
						<guimenuitem>Query</guimenuitem>
					</menuchoice></para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Toolbar</term>
				<listitem>
					<para>Click on the first button</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Shortcut Key</term>
				<listitem>
					<para>
						Press <keycombo><keycap>Ctrl</keycap><keycap>N</keycap></keycombo>
					</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Navigator</term>
				<listitem>
					<para>Double click on any datasource</para>
				</listitem>
			</varlistentry>
		</variablelist>
		<tip>
			Except when opening an editor by double-clicking on a datasource
			in the navigator, a new SQL editor is not bound to a connection.
		</tip>
		<para>
			A SQL editor has three parts:
		</para>
		<variablelist>
			<varlistentry>
				<term>Query</term>
				<listitem>
					<para>Textarea to enter queries</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Results Panel</term>
				<listitem>
					<para>
						The results panel below the textarea has the three
						tabs <guilabel>Results</guilabel>, <guilabel>Explain</guilabel>
						and <guilabel>Messages</guilabel>.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Statusbar</term>
				<listitem>
					<para>
						Each SQL editor has a statusbar below the results panel.
						It informs you about the current activities of an 
						SQL editor.
					</para>
				</listitem>
			</varlistentry>
		</variablelist>
	</section>
	<section id="queries_execute">
  		<title>Execute Queries</title>
  		<para>
  			To execute a query press <keycode>F5</keycode> or
  			click on the execute button in the toolbar. The result of
  			a query will be displayed in the results panel, when the
  			query has finished.
  		</para>
  		<caution>
			<para>
				Unfortunately the SQL editor has no integrated SQL parser
				for now. If the SQL editor or the selected text has more
				then one statement, all statements are executed by the
				current connection at once.
				But only the return value or the result of the last query
				will be displayed in the results pane.
			</para>
		</caution>
		<tip>
			<para>
				Statements can contain placholders. Placeholders begin with
				a dollar sign followed by one or more letters and numbers.
				If you user placeholders a dialog pops up before the query is
				executed where you can replace the placeholders with concrete
				values.
			</para>
			<para>
				To disable this function open the preferences dialog:
				<menuchoice>
					<guilabel>Editor</guilabel>
					<guilabel>General</guilabel>
					<guilabel>Replace variables</guilabel>
				</menuchoice>
			</para>
		</tip>
  	</section>
  	<section id="queries_results">
  		<title>Query Results</title>
  		<para>
  			If a query returns data from your database, they are displayed
  			in the results panel within the <guilabel>Results</guilabel>
  			tab.
  		</para>
  		<caution>
  			<para>
  				<application>CrunchyFrog</application> displays alwas
  				<emphasis role="bold">all</emphasis> returned rows.
  				This can result in perfomance issues under some circumstances.
  			</para>
  			<para>
  				If displaying a huge dataset results in performance issues
  				depends on both the number of rows and the number of
  				columns that are displayed in the data grid.
  				A query that returns 350.000 rows with 12 columns could
  				result in better performance of the result grid than a
  				query that returns only 10.000 rows with a lot of 
  				columns.
  			</para>
  		</caution>
  		<para>
  			You can select parts of the data displayed in the data grid
  			in the following ways:
  		</para>
  		<variablelist>
  			<varlistentry>
  				<term>Rows</term>
  				<listitem>
  					<para>
  						Click on the row number in the first column to select
  						a whole row.
  					</para>
  				</listitem>
  			</varlistentry>
  			<varlistentry>
  				<term>Columns</term>
  				<listitem>
  					<para>
  						Click on the column header to select a whole column.
  					</para>
  				</listitem>
  			</varlistentry>
  			<varlistentry>
  				<term>Cells</term>
  				<listitem>
  					<para>
  						Click on a cell to select individual cells.
  					</para>
  				</listitem>
  			</varlistentry>
  			<varlistentry>
  				<term>Select/Unselect All</term>
  				<listitem>
  					<para>
  						To select or unselect all cells click on the first (top left)
  						cell.
  					</para>
  				</listitem>
  			</varlistentry>
  		</variablelist>
  		<para>
  			Click on the <guibutton>Copy</guibutton> button in the toolbar
  			in an editor to copy selected cells, columns or rows to the
  			clipboard.
  			To export the dataset click on the <guibutton>Export</guibutton>
  			button in the toolbar. If you have made a selection before,
  			the export dialog gives you an option to export only the selected
  			data.
  		</para>
  		<tip>
  			<para>
  				See <xref linkend="crunchyfrog-plugins_export" /> for all available
  				export formats.
  			</para>
  		</tip>
  	</section>
  	<section id="queries_transactions">
  		<title>Transactions</title>
  		<para>
  			If it's supported by the database backend, transactions can be
  			used using the buttons in the toolbar. The transaction state
  			can be changed by statements executed in the editor, too.
  		</para>
  	</section>
</chapter>