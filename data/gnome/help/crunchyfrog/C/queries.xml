<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<chapter id="crunchyfrog-queries" lang="en" xmlns:xi="http://www.w3.org/2001/XInclude">
	<title>Datenbankabfragen</title>
	<section id="sqleditor">
		<title>SQL-Editor</title>
		<para>
			Ein SQL-Editor kann wie folgt geöffnet werden:
		</para>
		<variablelist>
			<varlistentry>
				<term>Menüleiste</term>
				<listitem><para>Wählen Sie
					<menuchoice>
						<guimenu>Datei</guimenu>
						<guisubmenu>Neu</guisubmenu>
						<guimenuitem>Abfrage</guimenuitem>
					</menuchoice></para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Werkzeugleiste</term>
				<listitem>
					<para>Wählen Sie die erste Schaltfläche</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Tastaturkürzel</term>
				<listitem>
					<para>
						Drücken Sie <keycombo><keycap>Strg</keycap><keycap>N</keycap></keycombo>
					</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Navigator</term>
				<listitem>
					<para>Doppelklick auf eine Datenquelle</para>
				</listitem>
			</varlistentry>
		</variablelist>
		<tip>
			Außer beim Öffnen über den Navigator wird einem neuen SQL-Editor keine
			Datenbankverbindung automatisch zugewiesen.
		</tip>
		<para>
			Ein SQL-Editor ist in drei Teile unterteilt:
		</para>
		<variablelist>
			<varlistentry>
				<term>Abfrage</term>
				<listitem>
					<para>Textfeld zur Eingabe der Abfragen</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Ergebnisbereich</term>
				<listitem>
					<para>
						Der Ergebnisbereich unterhalb des Textfeldes hat die
						drei Reiter <guilabel>Ergebnisse</guilabel>, 
						<guilabel>Explain</guilabel> und <guilabel>Meldungen</guilabel>.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>Statuszeile</term>
				<listitem>
					<para>
						Unterhalb des Ergebnisbereichs findet sich eine Statuszeile,
						die über die momentane Aktivität des SQL-Editors informiert.
					</para>
				</listitem>
			</varlistentry>
		</variablelist>
	</section>
	<section id="queries_execute">
  		<title>Abfragen ausführen</title>
  		<para>
  			Eine Abfrage kann mit <keycode>F5</keycode> oder über
  			die Schaltfläche in der Werkzeugleiste ausgeführt werden. Das Ergebnis
  			der Abfrage wird nach Beendigung der Abfrage im Ergebnisbereich angezeigt.
  		</para>
  		<caution>
			<para>
				Im SQL-Editor ist derzeit kein SQL-Parser integriert.
				Enthält der SQL-Editor, bzw. der selektierte Text,
				mehrere Abfragen, werden bei der Ausführung die Abfragen
				als Ganzes der Datenbankverbindung übergeben. Als Rückgabewert
				oder Ergebnis des Vorgangs kann jedoch nur das Ergebnis der
				letzten Abfrage ermittelt werden, da aufgrund der fehlenden
				SQL-Analyse nicht ermittelt werden kann, ob es sich um eine 
				einzelne oder um mehrere aufeinander folgende Abfragen handelt.
			</para>
		</caution>
		<tip>
			<para>
				Abfragen können Platzhalter entalten, die vor der Ausführung einer
				Abfrage in einem Dialog durch konkrete Werte erstetzt werden.
				Platzhalter beginnen mit einem Dollar-Zeichen.
			</para>
			<para>
				Diese Funktion kann in den Einstellungen unter
				<menuchoice>
					<guilabel>Editor</guilabel>
					<guilabel>Allgemein</guilabel>
					<guilabel>Variablen ersetzen</guilabel>
				</menuchoice>
				deaktiviert werden.
			</para>
		</tip>
  	</section>
  	<section id="queries_results">
  		<title>Abfrageergebnisse</title>
  		<para>
  			Liefert eine Abfrage Ergebnisse zurück, werden diese im
  			Ergebnisbereich im Reiter <guilabel>Ergebnisse</guilabel>
  			angezeigt.
  		</para>
  		<caution>
  			<para>
  				Es werden immer <emphasis role="bold">alle</emphasis> zurückgelieferten Zeilen einer Abfrage
  				angezeigt. Unter Umständen kann dies zu Performanceproblemen
  				führen.
  			</para>
  			<para>
  				Ob es zu Performanceeinbußen kommt ist sowohl von der Anzahl der
  				Zeilen, als auch von der Anzahl der Spalten abhängig. Eine Abfrage,
  				die über 350.000 Zeilen mit je 12 Spalten zurückliefert kann
  				in der Darstellung performanter sein, als eine Abfrage, die nur
  				knapp 10.000 Zeilen mit sehr vielen Spalten liefert.
  			</para>
  		</caution>
  		<para>
  			In der Ergebnisliste kann wie folgt selektiert werden:
  		</para>
  		<variablelist>
  			<varlistentry>
  				<term>Zeilen</term>
  				<listitem>
  					<para>Zeilen können durch Klick auf die Zeilennummern in der ersten Spalte selektiert werden.</para>
  				</listitem>
  			</varlistentry>
  			<varlistentry>
  				<term>Spalten</term>
  				<listitem>
  					<para>Spalten können durch Klick auf die Spaltenüberschriften selektiert werden.</para>
  				</listitem>
  			</varlistentry>
  			<varlistentry>
  				<term>Zellen</term>
  				<listitem>
  					<para>Einzelne oder mehrere Zellen werden duch Anklicken der jeweiligen Zellen selektiert.</para>
  				</listitem>
  			</varlistentry>
  			<varlistentry>
  				<term>Alles selektieren/deselektieren</term>
  				<listitem>
  					<para>Durch Klick auf die erste Zelle (links oben) werden alle Zellen selektiert oder deselektiert.</para>
  				</listitem>
  			</varlistentry>
  		</variablelist>
  		<para>
  			Selektierte Zellen, Spalten oder Zeilen können durch Klick auf die
  			<guibutton>Kopieren</guibutton>-Schaltfläche der Ergebnisliste in 
  			den Zwischenspeicher kopiert werden. Klicken Sie auf die
  			<guibutton>Exportieren</guibutton>-Schaltfläche, um Abfrageerbebnisse
  			in eine Datei zu exportieren. Falls zuvor Zellen, Spalten oder Zeilen
  			selektiert wurden, kann im Export-Dialog ausgewählt werden, ob alle
  			Ergebnisse oder nur die selektierten exportiert werden sollen.
  		</para>
  		<tip>
  			<para>In <xref linkend="crunchyfrog-plugins_export" /> finden Sie weitere Informationen
  			zu den verfügbaren Exportformaten.</para>
  		</tip>
  	</section>
  	<section id="queries_transactions">
  		<title>Transaktionen</title>
  		<para>
  			Sofern ein Datenbank-Backend Transaktionen unterstützt, können über
  			die Werkzeugleiste die Aktionen <guibutton>Transaktion beginnen</guibutton>,
  			<guibutton>Commit</guibutton> und <guibutton>Rollback</guibutton>
  			ausgelöst werden. Der Transaktionsstatus kann natürlich auch über
  			das Ausführen einer entsprechenden Abfrage geändert werden.
  		</para>
  	</section>
</chapter>